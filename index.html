<!DOCTYPE html>
<html lang="sv">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Status</title>
    <meta name="description" content="My personal status page" />
    <meta name="author" content="status" />

    <meta property="og:title" content="Jörgen Ivarssons status" />
    <meta property="og:type" content="website" />

    <link rel="icon" href="/favicon.ico" />
    <link rel="icon" href="/favicon.svg" type="image/svg+xml" />
    <link rel="apple-touch-icon" href="/apple-touch-icon.png" />

    <link rel="stylesheet" href="css/styles.css?v=1.0" />
  </head>

  <body>
    <div class="container">
      <h1>Jörgen Ivarsson</h1>

      <!-- Kalenderblad – behållet -->
      <div id="calendar">
        <div id="month"></div>
        <div id="day"></div>
        <div id="year"></div>
      </div>

      <!-- Veckodag -->
      <h3 id="weekday"></h3>

      <!-- Statuslista -->
      <div id="status">
        <ul id="week-status" style="list-style-type: none; padding: 0"></ul>
      </div>


      <div id="contact">
        <strong>Kontakt:</strong> <span id="contact-method"></span>
      </div>


      <div id="support">
        Behöver du support? Kontakta
        <a href="https://www.umu.se/servicedesk/kontakta-oss/">HelpDesk</a>
      </div>
    </div>

    <!-- JavaScript -->
    <script>
      const today = new Date();

      /* ===== Kalender (samma visning som tidigare) ===== */
      document.getElementById("month").textContent =
        today.toLocaleDateString("sv-SE", { month: "long" });

      document.getElementById("day").textContent =
        today.toLocaleDateString("sv-SE", { day: "numeric" });

      document.getElementById("year").textContent =
        today.toLocaleDateString("sv-SE", { year: "numeric" });

      document.getElementById("weekday").textContent =
        today.toLocaleDateString("sv-SE", { weekday: "long" });

      /* ===== Arbetsvecka + närvaro =====
         Justera "location" per din rutin:
         - "Kontoret"
         - "Hemifrån"
      */
      const workWeek = [
        { day: 1, name: "Måndag", location: "Kontoret" },
        { day: 2, name: "Tisdag", location: "Kontoret" },
        { day: 3, name: "Onsdag", location: "Hemifrån" },
        { day: 4, name: "Torsdag",location: "Kontoret" },
        { day: 5, name: "Fredag", location: "Kontoret" },
      ];

      function getRemainingWorkDays(referenceDate = new Date()) {
        const todayDay = referenceDate.getDay(); // 0–6 (0=sön, 1=mån,...,6=lör)
        // Filtrera fram idag + resterande till fredag
        return workWeek.filter((d) => d.day >= todayDay);
      }

      // Hämta dagens arbetsplats (endast mån–fre, annars null)
      function getTodayWorkLocation(referenceDate = new Date()) {
        const todayDay = referenceDate.getDay();
        const entry = workWeek.find((d) => d.day === todayDay);
        return entry ? entry.location : null;
      }

      // Översätt plats -> kontaktsätt
      function contactMethodFromLocation(location) {
        if (location === "Hemifrån") return "Teams";
        if (location === "Kontoret") return "Knacka på";
        return "—";
      }

      function renderWeekStatus() {
        const list = document.getElementById("week-status");
        list.innerHTML = "";

        const days = getRemainingWorkDays(today);

        if (days.length === 0) {
          const li = document.createElement("li");
          li.textContent = "Ingen arbetsdag kvar denna vecka";
          list.appendChild(li);
        } else {
          days.forEach((day, index) => {
            const li = document.createElement("li");
            if (index === 0) {
              li.innerHTML = `<strong>${day.name}</strong> – ${day.location}`;
            } else {
              li.textContent = `${day.name} – ${day.location}`;
            }
            list.appendChild(li);
          });
        }

        // Kontakt-raden baserat på Dagens status (mån–fre)
        const todaysLocation = getTodayWorkLocation(today);
        const contactText = contactMethodFromLocation(todaysLocation);
        document.getElementById("contact-method").textContent = contactText;
      }

      renderWeekStatus();
    </script>
  </body>
</html>
